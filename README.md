# 基于对话式推荐方法的智能问诊系统

   本项目旨在基于对话式推荐技术实现一个大语言模型驱动的的智能医疗问诊模型，使其能够通过主动询问厘清症状，以辅助实现更准确的疾病诊断，提高医疗咨询的效率和准确性。

  然而现有研究仍面临诸多挑战。首先，传统的基于模板的对话系统过于僵化，难以应对真实世界中的复杂场景；其次，尽管预训练语言模型具有较强的语言理解和生成能力，但在医疗问诊场景下缺乏主动提问能力和医学专业知识支撑。

  为应对上述挑战，本项目的主要工作如下：

（1）针对高质量多轮对话医疗问诊数据集稀缺问题，本文基于思维链提示，提出以症状为节点的单轮QA数据集转化为多轮对话数据集方法，在Huatuo26M-Lite数据集上进行实验，有效缓解了模型训练的数据瓶颈。

（2）使用关系图神经网络和注意力机制学习医学知识图谱实体嵌入，构建RGSARec模型用于确诊疾病预测推荐，在Huatuo26M-Lite转化数据集上进行对比和消融实验，结果显著优于基线和变体模型，表明了融合上下文实体与外部知识在推荐系统中的可带来显著性能增强。

（3）基于Qwen预训练模型，使用知识图谱计算词偏置与指令微调，用于向患者进行主动问询了解详细病情，在Huatuo26M-Lite转化数据集上进行对比和消融实验，结果显著优于基线和变体模型，表明了外部知识与指令微调在实际业务场景中的输出对齐作用。

部分代码框架基于CRSLAB【Zhou K, Wang X, Zhou Y, et al. CRSLab: An Open-Source Toolkit for Building Conversational Recommender System[J]. *arXiv e-prints,* 2021: arXiv: 2101. 00939.】，并对主要模块进行了重构

